<DbObjects>
  <DbObject Display="CCC_SecretServer_Assign_Permissions_To_Folders" Version="2">
    <Key>
      <Table Name="JobChain" Display="CCC_SecretServer_Assign_Permissions_To_Folders" Key="CCC-A3F24E5CC71C64449D3449CD7B4ADABC">
        <Prop Name="UID_JobChain">
          <Value>CCC-A3F24E5CC71C64449D3449CD7B4ADABC</Value>
        </Prop>
      </Table>
    </Key>
    <Columns>
      <Column Name="CustomRemarks">
        <Value>
        </Value>
      </Column>
      <Column Name="Description">
        <Value>
        </Value>
      </Column>
      <Column Name="GenCondition" Display="Value = $FK(UID_UNSGroupB).FK(UID_UNSRootB).Ident_UNSRoot$ = Connection.GetConfigParm(&quot;Custom\SecretServer\TargetSystemName&quot;) And&#xD;&#xA;		($FK(UID_UNSGroupB).GroupType$ = &quot;Department Folder&quot; Or $FK(UID_UNSGroupB).GroupType$ = &quot;Title Folder&quot;)">
        <Value>Value = $FK(UID_UNSGroupB).FK(UID_UNSRootB).Ident_UNSRoot$ = Connection.GetConfigParm("Custom\SecretServer\TargetSystemName") And
		($FK(UID_UNSGroupB).GroupType$ = "Department Folder" Or $FK(UID_UNSGroupB).GroupType$ = "Title Folder")</Value>
      </Column>
      <Column Name="LayoutPositions" Display="V1.1&#x7;CCC_Assign_Permission&#x8;20&#x8;158&#x7;JobChain_CCC_SecretServer_Assign_Permissions_To_Folders&#x8;20&#x8;20&#x8;R500">
        <Value>V1.1&#x7;CCC_Assign_Permission&#x8;20&#x8;158&#x7;JobChain_CCC_SecretServer_Assign_Permissions_To_Folders&#x8;20&#x8;20&#x8;R500</Value>
      </Column>
      <Column Name="LimitationCount" Display="0">
        <Value>0</Value>
      </Column>
      <Column Name="LimitationWarning" Display="0">
        <Value>0</Value>
      </Column>
      <Column Name="Name" Display="CCC_SecretServer_Assign_Permissions_To_Folders">
        <Value>CCC_SecretServer_Assign_Permissions_To_Folders</Value>
      </Column>
      <Column Name="NoGenerate" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="PreCode">
        <Value>
        </Value>
      </Column>
      <Column Name="PreProcessorCondition">
        <Value>
        </Value>
      </Column>
      <Column Name="ProcessDisplay">
        <Value>
        </Value>
      </Column>
      <Column Name="ProcessTracking" Display="None">
        <Value>0</Value>
      </Column>
      <Column Name="UID_DialogTable" Display="UNSAccountBInUNSGroupB">
        <Key>
          <Table Name="DialogTable" Display="UNSAccountBInUNSGroupB" Key="TSB-T-UNSAccountBInUNSGroupB">
            <Prop Name="UID_DialogTable">
              <Value>TSB-T-UNSAccountBInUNSGroupB</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="UID_Job" Display="CCC_Assign_Permission">
        <Key>
          <Table Name="Job" Display="CCC_Assign_Permission" Key="CCC-F0B8DEC50CA4A54AA40837758305A7FE">
            <Prop Name="UID_Job">
              <Value>CCC-F0B8DEC50CA4A54AA40837758305A7FE</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="UID_JobChain" Display="CCC-A3F24E5CC71C64449D3449CD7B4ADABC">
        <Value>CCC-A3F24E5CC71C64449D3449CD7B4ADABC</Value>
      </Column>
      <Column Name="XDateInserted" Display="10/4/2023 7:54:18 PM">
        <Value>2023-10-05T00:54:18.3400000Z</Value>
      </Column>
      <Column Name="XDateUpdated" Display="10/11/2023 7:54:33 PM">
        <Value>2023-10-12T00:54:33.6470000Z</Value>
      </Column>
      <Column Name="XMarkedForDeletion">
        <Value>0</Value>
      </Column>
      <Column Name="XObjectKey" Display="&lt;Key&gt;&lt;T&gt;JobChain&lt;/T&gt;&lt;P&gt;CCC-A3F24E5CC71C64449D3449CD7B4ADABC&lt;/P&gt;&lt;/Key&gt;">
        <Value>&lt;Key&gt;&lt;T&gt;JobChain&lt;/T&gt;&lt;P&gt;CCC-A3F24E5CC71C64449D3449CD7B4ADABC&lt;/P&gt;&lt;/Key&gt;</Value>
      </Column>
      <Column Name="XTouched">
        <Value>
        </Value>
      </Column>
      <Column Name="XUserInserted" Display="psherman">
        <Value>psherman</Value>
      </Column>
      <Column Name="XUserUpdated" Display="psherman">
        <Value>psherman</Value>
      </Column>
    </Columns>
  </DbObject>
  <DbObject Display="CCC_Assign_Permission" Version="2">
    <Key>
      <Table Name="Job" Display="CCC_Assign_Permission" Key="CCC-F0B8DEC50CA4A54AA40837758305A7FE">
        <Prop Name="UID_Job">
          <Value>CCC-F0B8DEC50CA4A54AA40837758305A7FE</Value>
        </Prop>
      </Table>
    </Key>
    <Columns>
      <Column Name="DeferOnError" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="Description" Display="Depending on the type of the group">
        <Value>Depending on the type of the group</Value>
      </Column>
      <Column Name="ErrorNotify" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="GenCondition">
        <Value>
        </Value>
      </Column>
      <Column Name="IgnoreErrors" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="IsErrorLogToJournal" Display="True">
        <Value>True</Value>
      </Column>
      <Column Name="IsForHistory" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="IsNoDBQueueDefer" Display="True">
        <Value>True</Value>
      </Column>
      <Column Name="IsSplitOnly" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="IsToFreezeOnError" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="MinutesToDefer" Display="0">
        <Value>0</Value>
      </Column>
      <Column Name="Name" Display="CCC_Assign_Permission">
        <Value>CCC_Assign_Permission</Value>
      </Column>
      <Column Name="NotifyAddress">
        <Value>
        </Value>
      </Column>
      <Column Name="NotifyAddressSuccess">
        <Value>
        </Value>
      </Column>
      <Column Name="NotifyBody">
        <Value>
        </Value>
      </Column>
      <Column Name="NotifyBodySuccess">
        <Value>
        </Value>
      </Column>
      <Column Name="NotifySender">
        <Value>
        </Value>
      </Column>
      <Column Name="NotifySenderSuccess">
        <Value>
        </Value>
      </Column>
      <Column Name="NotifySubject">
        <Value>
        </Value>
      </Column>
      <Column Name="NotifySubjectSuccess">
        <Value>
        </Value>
      </Column>
      <Column Name="PreCode">
        <Value>
        </Value>
      </Column>
      <Column Name="PreProcessorCondition">
        <Value>
        </Value>
      </Column>
      <Column Name="Priority" Display="3">
        <Value>3</Value>
      </Column>
      <Column Name="PriorityDefinition">
        <Value>
        </Value>
      </Column>
      <Column Name="ProcessDisplay">
        <Value>
        </Value>
      </Column>
      <Column Name="ProcessInfoLevel" Display="Basic information">
        <Value>0</Value>
      </Column>
      <Column Name="ProcessTracking" Display="None">
        <Value>0</Value>
      </Column>
      <Column Name="Retries" Display="0">
        <Value>0</Value>
      </Column>
      <Column Name="ServerDetectScript">
        <Value>
        </Value>
      </Column>
      <Column Name="SuccessNotify" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="UID_ErrorJob">
        <Value>
        </Value>
      </Column>
      <Column Name="UID_Job" Display="CCC-F0B8DEC50CA4A54AA40837758305A7FE">
        <Value>CCC-F0B8DEC50CA4A54AA40837758305A7FE</Value>
      </Column>
      <Column Name="UID_JobChain" Display="CCC_SecretServer_Assign_Permissions_To_Folders">
        <Key>
          <Table Name="JobChain" Display="CCC_SecretServer_Assign_Permissions_To_Folders" Key="CCC-A3F24E5CC71C64449D3449CD7B4ADABC">
            <Prop Name="UID_JobChain">
              <Value>CCC-A3F24E5CC71C64449D3449CD7B4ADABC</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="UID_JobTask" Display="ExecuteScript">
        <Key>
          <Table Name="JobTask" Display="ExecuteScript" Key="TSB-6FC2D53EC0D2294596B1E9B36F72B025">
            <Prop Name="UID_JobTask">
              <Value>TSB-6FC2D53EC0D2294596B1E9B36F72B025</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="UID_QBMServerTag" Display="Windows PowerShell Connector">
        <Key>
          <Table Name="QBMServerTag" Display="Windows PowerShell Connector" Key="TSB-Connector-POSH">
            <Prop Name="UID_QBMServerTag">
              <Value>TSB-Connector-POSH</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="UID_SuccessJob">
        <Value>
        </Value>
      </Column>
      <Column Name="XDateInserted" Display="10/4/2023 7:54:18 PM">
        <Value>2023-10-05T00:54:18.3830000Z</Value>
      </Column>
      <Column Name="XDateUpdated" Display="10/12/2023 9:18:53 AM">
        <Value>2023-10-12T14:18:53.6740000Z</Value>
      </Column>
      <Column Name="XMarkedForDeletion">
        <Value>0</Value>
      </Column>
      <Column Name="XObjectKey" Display="&lt;Key&gt;&lt;T&gt;Job&lt;/T&gt;&lt;P&gt;CCC-F0B8DEC50CA4A54AA40837758305A7FE&lt;/P&gt;&lt;/Key&gt;">
        <Value>&lt;Key&gt;&lt;T&gt;Job&lt;/T&gt;&lt;P&gt;CCC-F0B8DEC50CA4A54AA40837758305A7FE&lt;/P&gt;&lt;/Key&gt;</Value>
      </Column>
      <Column Name="XTouched">
        <Value>
        </Value>
      </Column>
      <Column Name="XUserInserted" Display="psherman">
        <Value>psherman</Value>
      </Column>
      <Column Name="XUserUpdated" Display="psherman">
        <Value>psherman</Value>
      </Column>
    </Columns>
  </DbObject>
  <DbObject Display="TSB-93D929F4A664B571B45F9CE204A70D3F" Version="2">
    <Key>
      <Table Name="JobEventGen" Display="TSB-93D929F4A664B571B45F9CE204A70D3F" Key="CCC-90BC370BA14B884187BFCA9E2117F2EE">
        <Prop Name="UID_JobEventGen">
          <Value>CCC-90BC370BA14B884187BFCA9E2117F2EE</Value>
        </Prop>
      </Table>
    </Key>
    <Columns>
      <Column Name="OrderNr" Display="0">
        <Value>0</Value>
      </Column>
      <Column Name="ProcessDisplay">
        <Value>
        </Value>
      </Column>
      <Column Name="UID_JobChain" Display="CCC-A3F24E5CC71C64449D3449CD7B4ADABC">
        <Key>
          <Table Name="JobChain" Display="CCC_SecretServer_Assign_Permissions_To_Folders" Key="CCC-A3F24E5CC71C64449D3449CD7B4ADABC">
            <Prop Name="UID_JobChain">
              <Value>CCC-A3F24E5CC71C64449D3449CD7B4ADABC</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="UID_JobEventGen" Display="CCC-90BC370BA14B884187BFCA9E2117F2EE">
        <Value>CCC-90BC370BA14B884187BFCA9E2117F2EE</Value>
      </Column>
      <Column Name="UID_QBMEvent" Display="TSB-93D929F4A664B571B45F9CE204A70D3F">
        <Key>
          <Table Name="QBMEvent" Display="ASSIGN - UNSAccountBInUNSGroupB" Key="TSB-93D929F4A664B571B45F9CE204A70D3F">
            <Prop Name="UID_QBMEvent">
              <Value>TSB-93D929F4A664B571B45F9CE204A70D3F</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="XDateInserted" Display="10/4/2023 7:54:18 PM">
        <Value>2023-10-05T00:54:18.3430000Z</Value>
      </Column>
      <Column Name="XDateUpdated" Display="10/4/2023 7:54:18 PM">
        <Value>2023-10-05T00:54:18.3430000Z</Value>
      </Column>
      <Column Name="XMarkedForDeletion">
        <Value>0</Value>
      </Column>
      <Column Name="XObjectKey" Display="&lt;Key&gt;&lt;T&gt;JobEventGen&lt;/T&gt;&lt;P&gt;CCC-90BC370BA14B884187BFCA9E2117F2EE&lt;/P&gt;&lt;/Key&gt;">
        <Value>&lt;Key&gt;&lt;T&gt;JobEventGen&lt;/T&gt;&lt;P&gt;CCC-90BC370BA14B884187BFCA9E2117F2EE&lt;/P&gt;&lt;/Key&gt;</Value>
      </Column>
      <Column Name="XTouched">
        <Value>
        </Value>
      </Column>
      <Column Name="XUserInserted" Display="psherman">
        <Value>psherman</Value>
      </Column>
      <Column Name="XUserUpdated" Display="psherman">
        <Value>psherman</Value>
      </Column>
    </Columns>
  </DbObject>
  <DbObject Display="OutParameterName" Version="2">
    <Key>
      <Table Name="JobRunParameter" Display="OutParameterName">
        <Prop Name="UID_Job">
          <Value>CCC-F0B8DEC50CA4A54AA40837758305A7FE</Value>
        </Prop>
        <Prop Name="UID_JobParameter">
          <Value>TSB-43950712FCF3254DB52BB8428A09D199</Value>
        </Prop>
      </Table>
    </Key>
    <Columns>
      <Column Name="IsCompressed" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="IsCrypted" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="IsHidden" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="IsPartialCrypted" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="Name" Display="OutParameterName">
        <Value>OutParameterName</Value>
      </Column>
      <Column Name="UID_Job" Display="CCC-F0B8DEC50CA4A54AA40837758305A7FE">
        <Key>
          <Table Name="Job" Display="CCC_Assign_Permission" Key="CCC-F0B8DEC50CA4A54AA40837758305A7FE">
            <Prop Name="UID_Job">
              <Value>CCC-F0B8DEC50CA4A54AA40837758305A7FE</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="UID_JobParameter" Display="TSB-43950712FCF3254DB52BB8428A09D199">
        <Key>
          <Table Name="JobParameter" Display="OutParameterName" Key="TSB-43950712FCF3254DB52BB8428A09D199">
            <Prop Name="UID_JobParameter">
              <Value>TSB-43950712FCF3254DB52BB8428A09D199</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="ValueTemplate" Display="Value=&quot;Output&quot;">
        <Value>Value="Output"</Value>
      </Column>
      <Column Name="XDateInserted" Display="10/4/2023 7:54:18 PM">
        <Value>2023-10-05T00:54:18.3900000Z</Value>
      </Column>
      <Column Name="XDateUpdated" Display="10/4/2023 7:54:18 PM">
        <Value>2023-10-05T00:54:18.3900000Z</Value>
      </Column>
      <Column Name="XMarkedForDeletion">
        <Value>0</Value>
      </Column>
      <Column Name="XObjectKey" Display="&lt;Key&gt;&lt;T&gt;JobRunParameter&lt;/T&gt;&lt;P&gt;CCC-F0B8DEC50CA4A54AA40837758305A7FE&lt;/P&gt;&lt;P&gt;TSB-43950712FCF3254DB52BB8428A09D199&lt;/P&gt;&lt;/Key&gt;">
        <Value>&lt;Key&gt;&lt;T&gt;JobRunParameter&lt;/T&gt;&lt;P&gt;CCC-F0B8DEC50CA4A54AA40837758305A7FE&lt;/P&gt;&lt;P&gt;TSB-43950712FCF3254DB52BB8428A09D199&lt;/P&gt;&lt;/Key&gt;</Value>
      </Column>
      <Column Name="XTouched">
        <Value>
        </Value>
      </Column>
      <Column Name="XUserInserted" Display="psherman">
        <Value>psherman</Value>
      </Column>
      <Column Name="XUserUpdated" Display="psherman">
        <Value>psherman</Value>
      </Column>
    </Columns>
  </DbObject>
  <DbObject Display="Script" Version="2">
    <Key>
      <Table Name="JobRunParameter" Display="Script">
        <Prop Name="UID_Job">
          <Value>CCC-F0B8DEC50CA4A54AA40837758305A7FE</Value>
        </Prop>
        <Prop Name="UID_JobParameter">
          <Value>TSB-0304150431B60044B56F6B839A2D1A81</Value>
        </Prop>
      </Table>
    </Key>
    <Columns>
      <Column Name="IsCompressed" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="IsCrypted" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="IsHidden" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="IsPartialCrypted" Display="False">
        <Value>False</Value>
      </Column>
      <Column Name="Name" Display="Script">
        <Value>Script</Value>
      </Column>
      <Column Name="UID_Job" Display="CCC-F0B8DEC50CA4A54AA40837758305A7FE">
        <Key>
          <Table Name="Job" Display="CCC_Assign_Permission" Key="CCC-F0B8DEC50CA4A54AA40837758305A7FE">
            <Prop Name="UID_Job">
              <Value>CCC-F0B8DEC50CA4A54AA40837758305A7FE</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="UID_JobParameter" Display="TSB-0304150431B60044B56F6B839A2D1A81">
        <Key>
          <Table Name="JobParameter" Display="Script" Key="TSB-0304150431B60044B56F6B839A2D1A81">
            <Prop Name="UID_JobParameter">
              <Value>TSB-0304150431B60044B56F6B839A2D1A81</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="ValueTemplate" Display="Dim Username = Connection.GetConfigParm(&quot;Custom\SecretServer\Username&quot;) '&quot;d-admin&quot; &#xD;&#xA;Dim Password = Connection.GetConfigParm(&quot;Custom\SecretServer\Password&quot;) '&quot;0neIdentity!&quot; &#xD;&#xA;Dim BaseURL =  Connection.GetConfigParm(&quot;Custom\SecretServer\BaseURL&quot;)  '&quot;https://services-us-texas-m-1.skytap.com:9114/SecretServer&quot; &#xD;&#xA;Dim GrantType = Connection.GetConfigParm(&quot;Custom\SecretServer\GrantType&quot;) '&quot;password&quot;&#xD;&#xA;Dim LogFolder = Connection.GetConfigParm(&quot;Custom\SecretServer\LogFolder&quot;) '&quot;C:\1Identity\Products\Thycotic Secret Server\Connector\Logs&quot;&#xD;&#xA;Dim DoDebug = Connection.GetConfigParm(&quot;Custom\SecretServer\DoDebug&quot;)     '&quot;true&quot;&#xD;&#xA;Dim psModule = Connection.GetConfigParm(&quot;Custom\SecretServer\PSModule&quot;) &#xD;&#xA;&#xD;&#xA;Dim folderAccess = &quot;&quot;&#xD;&#xA;Dim secretAccess = &quot;&quot;&#xD;&#xA;Dim userId = $FK(UID_UNSAccountB).ObjectGUID$&#xD;&#xA;Dim folderId = $FK(UID_UNSGroupB).ObjectGUID$&#xD;&#xA;Dim adminGroupID = Connection.GetConfigParm(&quot;Custom\SecretServer\AdminGroupID&quot;)&#xD;&#xA;&#xD;&#xA;If $FK(UID_UNSGroupB).GroupType$ = &quot;Department Folder&quot; Then&#xD;&#xA;	folderAccess = &quot;View&quot;&#xD;&#xA;	secretAccess = &quot;List&quot;&#xD;&#xA;ElseIf $FK(UID_UNSGroupB).GroupType$ = &quot;Title Folder&quot; Then&#xD;&#xA;	folderAccess = &quot;Edit&quot;&#xD;&#xA;	secretAccess = &quot;Edit&quot;&#xD;&#xA;Else&#xD;&#xA;	Throw New Exception($FK(UID_UNSGroupB).GroupType$ + &quot; is unknown folder type&quot;)&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;Dim cmd As Xml.Linq.XElement = &lt;pshell&gt;&#xD;&#xA;Import-Module &quot;&lt;%= psModule %&gt;&quot;&#xD;&#xA;SetParameters -BaseURL &quot;&lt;%= BaseURL %&gt;&quot; `&#xD;&#xA; 		-Username &quot;&lt;%= Username %&gt;&quot; `&#xD;&#xA;   		-Password &quot;&lt;%= Password %&gt;&quot; `&#xD;&#xA;	    -GrantType &quot;&lt;%= GrantType %&gt;&quot; `&#xD;&#xA;	    -LogFolder &quot;&lt;%= LogFolder %&gt;&quot; `&#xD;&#xA;	    -DoDebug &quot;&lt;%= DoDebug %&gt;&quot; &#xD;&#xA;&#xD;&#xA;$folderPerm = FolderPermissionCreate -folderAccessName &quot;&lt;%= folderAccess %&gt;&quot; -secretAccessName &quot;&lt;%= secretAccess %&gt;&quot; -userId &lt;%= userId %&gt; -folderId &lt;%= folderId %&gt; &#xD;&#xA;$folderPerm = FolderPermissionCreate -folderAccessName &quot;Owner&quot; -secretAccessName &quot;List&quot; -groupId &lt;%= adminGroupID %&gt; -folderId &lt;%= folderId %&gt;&#xD;&#xA;Disconnect&#xD;&#xA;&#xD;&#xA;&lt;/pshell&gt;&#xD;&#xA;&#xD;&#xA;'System.IO.File.WriteAllText(&quot;C:\1Identity\Products\Thycotic Secret Server\Connector 2 With Folders and Permissions\Logs\TitleFolderLog.txt&quot;, cmd.Value)&#xD;&#xA;'AppData.Instance.RaiseMessage(MsgSeverity.Warning, cmd.Value)&#xD;&#xA;&#xD;&#xA;Value = cmd.Value&#xD;&#xA;">
        <Value>Dim Username = Connection.GetConfigParm("Custom\SecretServer\Username") '"d-admin" 
Dim Password = Connection.GetConfigParm("Custom\SecretServer\Password") '"0neIdentity!" 
Dim BaseURL =  Connection.GetConfigParm("Custom\SecretServer\BaseURL")  '"https://services-us-texas-m-1.skytap.com:9114/SecretServer" 
Dim GrantType = Connection.GetConfigParm("Custom\SecretServer\GrantType") '"password"
Dim LogFolder = Connection.GetConfigParm("Custom\SecretServer\LogFolder") '"C:\1Identity\Products\Thycotic Secret Server\Connector\Logs"
Dim DoDebug = Connection.GetConfigParm("Custom\SecretServer\DoDebug")     '"true"
Dim psModule = Connection.GetConfigParm("Custom\SecretServer\PSModule") 

Dim folderAccess = ""
Dim secretAccess = ""
Dim userId = $FK(UID_UNSAccountB).ObjectGUID$
Dim folderId = $FK(UID_UNSGroupB).ObjectGUID$
Dim adminGroupID = Connection.GetConfigParm("Custom\SecretServer\AdminGroupID")

If $FK(UID_UNSGroupB).GroupType$ = "Department Folder" Then
	folderAccess = "View"
	secretAccess = "List"
ElseIf $FK(UID_UNSGroupB).GroupType$ = "Title Folder" Then
	folderAccess = "Edit"
	secretAccess = "Edit"
Else
	Throw New Exception($FK(UID_UNSGroupB).GroupType$ + " is unknown folder type")
End If

Dim cmd As Xml.Linq.XElement = &lt;pshell&gt;
Import-Module "&lt;%= psModule %&gt;"
SetParameters -BaseURL "&lt;%= BaseURL %&gt;" `
 		-Username "&lt;%= Username %&gt;" `
   		-Password "&lt;%= Password %&gt;" `
	    -GrantType "&lt;%= GrantType %&gt;" `
	    -LogFolder "&lt;%= LogFolder %&gt;" `
	    -DoDebug "&lt;%= DoDebug %&gt;" 

$folderPerm = FolderPermissionCreate -folderAccessName "&lt;%= folderAccess %&gt;" -secretAccessName "&lt;%= secretAccess %&gt;" -userId &lt;%= userId %&gt; -folderId &lt;%= folderId %&gt; 
$folderPerm = FolderPermissionCreate -folderAccessName "Owner" -secretAccessName "List" -groupId &lt;%= adminGroupID %&gt; -folderId &lt;%= folderId %&gt;
Disconnect

&lt;/pshell&gt;

'System.IO.File.WriteAllText("C:\1Identity\Products\Thycotic Secret Server\Connector 2 With Folders and Permissions\Logs\TitleFolderLog.txt", cmd.Value)
'AppData.Instance.RaiseMessage(MsgSeverity.Warning, cmd.Value)

Value = cmd.Value
</Value>
      </Column>
      <Column Name="XDateInserted" Display="10/4/2023 7:54:18 PM">
        <Value>2023-10-05T00:54:18.4130000Z</Value>
      </Column>
      <Column Name="XDateUpdated" Display="10/12/2023 9:00:11 AM">
        <Value>2023-10-12T14:00:11.7030000Z</Value>
      </Column>
      <Column Name="XMarkedForDeletion">
        <Value>0</Value>
      </Column>
      <Column Name="XObjectKey" Display="&lt;Key&gt;&lt;T&gt;JobRunParameter&lt;/T&gt;&lt;P&gt;CCC-F0B8DEC50CA4A54AA40837758305A7FE&lt;/P&gt;&lt;P&gt;TSB-0304150431B60044B56F6B839A2D1A81&lt;/P&gt;&lt;/Key&gt;">
        <Value>&lt;Key&gt;&lt;T&gt;JobRunParameter&lt;/T&gt;&lt;P&gt;CCC-F0B8DEC50CA4A54AA40837758305A7FE&lt;/P&gt;&lt;P&gt;TSB-0304150431B60044B56F6B839A2D1A81&lt;/P&gt;&lt;/Key&gt;</Value>
      </Column>
      <Column Name="XTouched">
        <Value>
        </Value>
      </Column>
      <Column Name="XUserInserted" Display="psherman">
        <Value>psherman</Value>
      </Column>
      <Column Name="XUserUpdated" Display="psherman">
        <Value>psherman</Value>
      </Column>
    </Columns>
  </DbObject>
  <DbObject Display="ASSIGN - UNSAccountBInUNSGroupB" Version="2">
    <Key>
      <Table Name="QBMEvent" Display="ASSIGN - UNSAccountBInUNSGroupB" Key="TSB-93D929F4A664B571B45F9CE204A70D3F">
        <Prop Name="UID_QBMEvent">
          <Value>TSB-93D929F4A664B571B45F9CE204A70D3F</Value>
        </Prop>
      </Table>
    </Key>
    <Columns>
      <Column Name="DisplayName" Display="ASSIGN - UNSAccountBInUNSGroupB">
        <Value>ASSIGN - UNSAccountBInUNSGroupB</Value>
      </Column>
      <Column Name="EventName" Display="ASSIGN">
        <Value>ASSIGN</Value>
      </Column>
      <Column Name="UID_DialogTable" Display="UNSAccountBInUNSGroupB">
        <Key>
          <Table Name="DialogTable" Display="UNSAccountBInUNSGroupB" Key="TSB-T-UNSAccountBInUNSGroupB">
            <Prop Name="UID_DialogTable">
              <Value>TSB-T-UNSAccountBInUNSGroupB</Value>
            </Prop>
          </Table>
        </Key>
      </Column>
      <Column Name="UID_QBMEvent" Display="TSB-93D929F4A664B571B45F9CE204A70D3F">
        <Value>TSB-93D929F4A664B571B45F9CE204A70D3F</Value>
      </Column>
      <Column Name="XDateInserted" Display="12/7/2021 12:46:51 PM">
        <Value>2021-12-07T18:46:51.9300000Z</Value>
      </Column>
      <Column Name="XDateUpdated" Display="12/7/2021 12:46:51 PM">
        <Value>2021-12-07T18:46:51.9300000Z</Value>
      </Column>
      <Column Name="XMarkedForDeletion">
        <Value>0</Value>
      </Column>
      <Column Name="XObjectKey" Display="&lt;Key&gt;&lt;T&gt;QBMEvent&lt;/T&gt;&lt;P&gt;TSB-93D929F4A664B571B45F9CE204A70D3F&lt;/P&gt;&lt;/Key&gt;">
        <Value>&lt;Key&gt;&lt;T&gt;QBMEvent&lt;/T&gt;&lt;P&gt;TSB-93D929F4A664B571B45F9CE204A70D3F&lt;/P&gt;&lt;/Key&gt;</Value>
      </Column>
      <Column Name="XTouched">
        <Value>
        </Value>
      </Column>
      <Column Name="XUserInserted" Display="QBM_PBufferT_ProcessInsert">
        <Value>QBM_PBufferT_ProcessInsert</Value>
      </Column>
      <Column Name="XUserUpdated" Display="QBM_PBufferT_ProcessInsert">
        <Value>QBM_PBufferT_ProcessInsert</Value>
      </Column>
    </Columns>
  </DbObject>
</DbObjects>